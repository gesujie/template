<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
<!-- 
    <link rel="stylesheet" type="text/css" href="http://www.jeasyui.com/easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="http://www.jeasyui.com/easyui/themes/icon.css">
    <script type="text/javascript" src="http://www.jeasyui.com/easyui/jquery.min.js"></script>
    <script type="text/javascript" src="http://www.jeasyui.com/easyui/jquery.easyui.min.js"></script> -->

    <link href="../assets/stylesheets/application.css" rel="stylesheet" type="text/css" />
    <script src="../assets/javascripts/vendor/jquery-2.1.3.min.js" type="text/javascript"></script>
    <script src="../assets/javascripts/vendor/jquery.easyui.min.js" type="text/javascript"></script>
    <script src="../assets/javascripts/main.js" type="text/javascript"></script>

</head>
<body>
<div class="easyui-layout" fit="true">
    <!-- 右方编辑侧边栏 -->
    <div data-options="region:'east',cls:'layout-panel panel-primary pl-10',title:'人员信息编辑'" style="width:300px;">
        <form class='form-horizontal' id="qc-adminMngEmp-editForm">
            <input type="hidden" name="empId">
            <div class='form-group'>
                <label class="col-3 control-label">工号：</label>
                <div class="col-9 col-last">
                    <input class='form-control easyui-textbox' name="empCode" data-options='width:180, height:32, prompt: "请输入工号"'>
                </div>
            </div>
            <div class='form-group'>
                <label class="col-3 control-label">姓名：</label>
                <div class="col-9 col-last">
                    <input class='form-control easyui-textbox' name="empName" data-options='width:180, height:32, prompt: "请输入姓名"'>
                </div>
            </div>
            <div class='form-group'>
                <label class="col-3 control-label">电话：</label>
                <div class="col-9 col-last">
                    <input class='form-control easyui-textbox' name="phone" data-options='width:180, height:32, prompt: "请输入电话号码"'>
                </div>
            </div>
            <div class='form-group'>
                <label class="col-3 control-label">部门：</label>
                <div class="col-9 col-last">
                    <input class='form-control easyui-textbox' id="qc-adminMngEmp-comboDeptEdit" name="deptId" data-options='width:180, height:32, prompt: "请选择部门"'>
                </div>
            </div>
            <div class='form-group'>
                <label class="col-3 control-label">岗位：</label>
                <div class="col-9 col-last">
                    <input class='form-control' id="qc-adminMngEmp-comboPost">
                </div>
            </div>
            <div class='form-group'>
                <label class="col-3 control-label">用户名：</label>
                <div class="col-9 col-last">
                    <input class='form-control easyui-textbox' data-options='width:180, height:32, prompt: "请输入用户名"'>
                </div>
            </div>
            <div class='form-group'>
                <label class="col-3 control-label">性别：</label>
                <div class="col-9 col-last">
                    <input type="radio" name="sex" value="1"/>男
                    <input type="radio" name="sex" value="0"/>女
                </div>
            </div>
            <div class='form-group'>
                <div class="col-9 col-last">
                    <a iconcls="fa fa-plus" class="easyui-linkbutton color-default" onclick="qc.adminMngEmp.add();" href="javascript:void(0)">新增</a>
                    <a iconcls="fa fa-save" class="easyui-linkbutton color-default" onclick="qc.adminMngEmp.save();" href="javascript:void(0)">保存</a>
                </div>
            </div>
        </form>
    </div>

    <!-- 中部展示区域 -->
    <div data-options="region:'center'">
        <div class="easyui-layout" fit="true">
            <div data-options="region:'north',cls:'layout-panel panel-primary',title:'人员信息查询'" style="height:105px;">

                <!-- 搜索表单 -->
                <form class="form-inline" id="qc-adminMngEmp-searchForm">
                    <div class='form-group'>
                        <label>部门:</label>
                        <input class='form-control easyui-textbox' id="qc-adminMngEmp-comboDeptSh" name="deptId" data-options='height:32, width:80'>
                    </div>
                    <div class='form-group'>
                        <label>名字:</label>
                        <input class='form-control easyui-textbox' name="empName" data-options='height:32, width:80'>
                    </div>
                    <div class='form-group'>
                        <label>工号:</label>
                        <input class='form-control easyui-textbox' name="empCode" data-options='height:32, width:80'>
                    </div>
                    <div class='form-group'>
                        <label>手机号:</label>
                        <input class='form-control easyui-textbox' name="phone" data-options='height:32, width:80'>
                    </div>
                    <a iconcls="fa fa-search" class="easyui-linkbutton color-default" onclick="qc.adminMngEmp.search();" href="javascript:void(0)">查询</a>
                    <a iconcls="fa fa-undo" class="easyui-linkbutton color-default" onclick="qc.adminMngEmp.searchReset();" href="javascript:void(0)">重置</a>
                </form>
            </div>

            <!-- 列表生成区域 -->
            <div data-options="region:'center'">
                <table id="qc-adminMngEmp-dgEmp"></table>
            </div>
        </div>
    </div> 
</div>


<script>
$(function() {
// 注册本页命名空间
Namespace.register("qc.adminMngEmp");

// 初始化查询条件中的部门下拉框
qc.adminMngEmp.comboDeptSh = $("#qc-adminMngEmp-comboDeptSh").combotree({
    width:120, height:32, prompt: "请选择搜索部门",
    valueField: "id",
    textField: "text",
    parentField: "pid",
    data: [{"id": 1, "text": "都匀"},
           {"id": 2, "text": "贵定"},
           {"id": 3, "text": "麻江"},
           {"id": 4, "text": "平塘"},
           {"id": 5, "text": "贵定1", "pid": "2"},
           {"id": 6, "text": "贵定2", "pid": "2"}],
    onSelect: function(node){ 
        qc.adminMngEmp.editForm.form("clear");
        qc.adminMngEmp.comboDeptEdit.combotree("setValue", node.id);
    }
});

// 初始化编辑表单中的部门下拉框
qc.adminMngEmp.comboDeptEdit = $("#qc-adminMngEmp-comboDeptEdit").combotree({
    width:180, height:32, prompt: "请选择编辑部门",
    valueField: "id",
    textField: "text",
    parentField: "pid",
    data: qc.adminMngEmp.comboDeptSh.combotree("options").data,
    onSelect: function(rec){ 
        console.info(rec);
    }
});

// 初始化岗位下拉框
qc.adminMngEmp.comboPost = $("#qc-adminMngEmp-comboPost").combobox({
    width:180, height:32, prompt: "请选择岗位",
    multiple:true,
    valueField: "id",
    textField: "text",
    data: [{"id": 1, "text": "所长"},
           {"id": 2, "text": "操作员"},
           {"id": 3, "text": "调度员"}],
    onSelect: function(rec){ 
        console.info(rec);
    }
});

// 默认datagrid查询函数，用于初始化查询
qc.adminMngEmp.defaultSearchParams = {
    deptId: "00010001001"
};

// 初始化列表
qc.adminMngEmp.dgEmp = $("#qc-adminMngEmp-dgEmp").datagrid({
    data: [{empId: 1, empCode: "dg0001", empName: "张三", deptId: "生产设备部", post: "操作员", username: "dg0001", sex: 0}],
    queryParams: qc.adminMngEmp.defaultSearchParams,
    cls: "panel-primary",
    title: "人员信息列表",
    pagination: true,
    fit: true,
    columns:[[    
        {field: 'empId', checkbox: true},
        {field: 'empName',title: '姓名', width:100, align: 'center'},
        {field: 'empCode',title: '工号', width:100, align: 'center'},
        {field: 'deptId',title: '部门', width:100, align: 'center'},
        {field: 'phone',title: '电话号码', width:100, halign: 'center'},
        {field: 'post',title: '岗位', width:80, align: 'center',},
        {field: 'username',title: '用户名', width:100, align: 'center',},
        {field: 'sex',title: '性别', width:60, align: 'center',}
    ]],
    onSelect: function(index, row) {
        qc.adminMngEmp.edit(row);
    }
});

// 初始化编辑表单、搜索表单
qc.adminMngEmp.editForm = $("#qc-adminMngEmp-editForm").form();
qc.adminMngEmp.searchForm = $("#qc-adminMngEmp-searchForm").form();

// 添加函数
qc.adminMngEmp.add = function() {
    qc.adminMngEmp.editForm.form("clear");
};

// 编辑行，如果没有提供行，进行相应提示
qc.adminMngEmp.edit = function(row) {
    qc.adminMngEmp.editForm.form("clear");
    row = !!row ? row : qc.adminMngEmp.dgEmp.datagrid("getSelected");
    if(row == null) {
        $.showMessage({msg:"请选择一行数据进行编辑"});
        return;
    } else {
        qc.adminMngEmp.editForm.form("load", row);
    }
};

// 删除函数
qc.adminMngEmp.remove = function(row) {
    qc.adminMngEmp.editForm.form("clear");
    row = !!row ? row : qc.adminMngEmp.dgEmp.datagrid("getSelected");
    if(row == null) {
        $.showMessage({msg:"请选择需要删除的行"});
        return;
    } else {
        $.post("", row, function(json) {
            if(json.success) {
                qc.adminMngEmp.dgEmp.datagrid("refresh");
            } else {
                $.showMessage({msg:"删除失败，原因：" + json.msg});
            }
        }, "json");
    }
};


// 保存编辑表单
qc.adminMngEmp.save = function() {
    // 序列化表单对象，根据id是否为空，判断提交地址
    var saveObj = $.serializeObject(qc.adminMngEmp.editForm),
        saveUrl = saveObj.empId == "" ? "adminMng/emp/add.do" : "adminMng/emp/edit.do";

    // 提交编辑表单到后台
    $.post(saveUrl, saveObj, function(json) {
        if(json.success) {
            qc.adminMngEmp.dgEmp.datagrid("refresh");
            $.showMessage({msg:"保存成功！"});
        } else {
            $.showMessage({msg:"保存失败，原因：" + json.msg});
        }
    }, "json");
};

// 搜索函数，序列化表单，读取到datagrid中
qc.adminMngEmp.search = function() {
    var searchObj = $.serializeObject(qc.adminMngEmp.searchForm);
    console.info(searchObj);
    qc.adminMngEmp.dgEmp.datagrid("load", searchObj);
};

// 重置搜索函数
qc.adminMngEmp.searchReset = function() {
    qc.adminMngEmp.searchForm.form("clear");
    var searchObj = $.serializeObject(qc.adminMngEmp.searchForm);
    qc.adminMngEmp.dgEmp.datagrid("load", qc.adminMngEmp.defaultSearchParams);
};

});
</script>


</body>
</html>